require.config({baseUrl:"/javascript",waitSeconds:0,urlArgs:"bust="+(new Date).getTime(),paths:{jquery:"lib/jquery/jquery.min",underscore:"lib/underscore/underscore-min",nicescroll:"vendor/jquery.nicescroll/jquery.nicescroll.min",store2:"lib/store/dist/store2.min",Q:"lib/q/q",backbone:"lib/backbone/backbone-min",wreqr:"lib/backbone.wreqr/lib/backbone.wreqr.min",tpl:"lib/requirejs-tpl/tpl",text:"lib/requirejs-text/text",marionette:"lib/backbone.marionette/lib/backbone.marionette.min",jquery_ui:"vendor/jquery-ui/jquery-ui.min",easing:"lib/jquery-easing/jquery.easing.min",i18n:"lib/i18next/i18next.amd.withJQuery.min",jquery_event_drag:"lib/slickgrid/lib/jquery.event.drag-2.2",slickgrid_core:"lib/slickgrid/slick.core",slickgrid:"lib/slickgrid/slick.grid",slick_rowselect:"lib/slickgrid/plugins/slick.rowselectionmodel",slick_checkbox:"vendor/plugin/slick.checkboxselectcolumn",moment:"lib/moment/moment","moment-timezone":"lib/moment-timezone/builds/moment-timezone-with-data.min",zeroclipboard:"lib/zeroclipboard/dist/ZeroClipboard.min",daterangepicker:"vendor/bootstrap-daterangepicker/daterangepicker",pnotify:"vendor/pnotify/pnotify.core","pnotify.buttons":"vendor/pnotify/pnotify.buttons","pnotify.nonblock":"vendor/pnotify/pnotify.nonblock","visualcaptcha.jquery":"vendor/visualcaptcha.jquery/visualcaptcha.jquery",validate:"lib/jquery.validation/dist/jquery.validate.min",scrollTo:"lib/jquery.scrollTo/jquery.scrollTo.min",pace:"lib/pace/pace.min","jquery-sortable":"lib/jquery-sortable/source/js/jquery-sortable-min",basic:"core/basic",data:"core/basic/data",event:"core/basic/event",net:"core/basic/net",view:"core/basic/view",other:"core/basic/other",dispatcher:"core/functions/Dispatcher",U:"core/functions/Utils",Storage:"core/functions/Storage",Timezone:"core/functions/Timezone",Cookie:"core/functions/Cookie",Logger:"core/functions/Logger",State:"core/functions/State",app:"core/functions/App",formatter:"core/functions/Formatter",language:"core/functions/Language",UI:"core/functions/UI",layout:"core/layout",container:"core/container",component:"core/component",emptyView:"core/component/empty/view",store:"core/store",extend:"core/extend",Captcha:"core/functions/Captcha",C:"config/Config",API:"config/API",semanticui:"../semanticui/dist/semantic",semanticui_accordion:"../semanticui/dist/components/accordion.min",semanticui_checkbox:"../semanticui/dist/components/checkbox.min",semanticui_dimmer:"../semanticui/dist/components/dimmer.min",semanticui_dropdown:"../semanticui/dist/components/dropdown.min",semanticui_form:"../semanticui/dist/components/form.min",semanticui_modal:"../semanticui/dist/components/modal.min",semanticui_popup:"../semanticui/dist/components/popup.min",semanticui_progress:"../semanticui/dist/components/progress.min",semanticui_search:"../semanticui/dist/components/search.min",semanticui_dropdown2:"../semanticui/dist/components/select2.min",semanticui_site:"../semanticui/dist/components/site.min",semanticui_state:"../semanticui/dist/components/state.min",semanticui_tab:"../semanticui/dist/components/tab.min",semanticui_transition:"../semanticui/dist/components/transition.min",semanticui_visibility:"../semanticui/dist/components/visibility.min",com_fun:"modules/common/function",jsonview:"lib/jquery-jsonview/dist/jquery.jsonview",spinjs:"lib/spinjs/spin"},shim:{main:{deps:[],exports:"main"},jquery:{deps:[],exports:"jQuery"},"pnotify.buttons":{deps:["pnotify"]},"pnotify.nonblock":{deps:["pnotify"]},nicescroll:{deps:["jquery"]},"jquery-sortable":{deps:["jquery"]},jquery_event_drag:{deps:["jquery"]},underscore:{deps:[],exports:"_"},backbone:{deps:["underscore","jquery"],exports:"Backbone"},marionette:{deps:["backbone"],exports:"Marionette"},wreqr:{deps:["backbone"]},easing:{deps:["jquery"],exports:"easing"},i18n:{deps:["jquery"],exports:"i18n"},scrollTo:{deps:["jquery"]},slickgrid_core:{deps:["jquery"],exports:"slickgrid_core"},slickgrid:{deps:["jquery_ui","slickgrid_core","jquery_event_drag"],exports:"Slick"},slick_rowselect:{deps:["slickgrid"]},slick_checkbox:{deps:["slickgrid"]},moment:{exports:"moment",init:function(){return window.moment=this.moment,this.moment}},"moment-timezone":{deps:["moment"],exports:"moment-timezone"},semanticui:{deps:["jquery"]},semanticui_accordion:{deps:["jquery"]},semanticui_api:{deps:["jquery"]},semanticui_checkbox:{deps:["jquery"]},semanticui_dimmer:{deps:["jquery"]},semanticui_dropdown:{deps:["jquery"]},semanticui_form:{deps:["jquery"]},semanticui_nag:{deps:["jquery"]},semanticui_popup:{deps:["jquery"]},semanticui_progress:{deps:["jquery"]},semanticui_rating:{deps:["jquery"]},semanticui_search:{deps:["jquery"]},semanticui_dropdown2:{deps:["jquery"]},semanticui_shape:{deps:["jquery"]},semanticui_sidebar:{deps:["jquery"]},semanticui_site:{deps:["jquery"]},semanticui_state:{deps:["jquery"]},semanticui_tab:{deps:["jquery"]},semanticui_transition:{deps:["jquery"]},semanticui_video:{deps:["jquery"]},semanticui_visibility:{deps:["jquery"]},semanticui_modal:{deps:["semanticui_transition","semanticui_dimmer"],exports:"semanticui_modal"},jsonview:{deps:["jquery"]}}}),define("main",function(e){return function(){var t;return t||e.main}}(this)),define("app",["backbone","marionette"],function(e){var t=new e.Marionette.Application;return window.Application=t,t}),define("Storage",["store2"],function(e){return window.store2=e,{get:function(t){return e.local.get(t)},set:function(t,i){e.local.set(t,i)},remove:function(t){e.local.remove(t)},clear:function(){e.local.clearAll()}}}),define("config/App",[],function(){return{isDebug:!1,isProduct:!0}}),function(e){"function"==typeof define&&define.amd?define("lang/en",["moment"],e):"object"==typeof exports?module.exports=e(require("../moment")):e(window.moment)}(function(e){return e.locale("en",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",L:"YYYY-MM-DD",LL:"MMM D",LLL:"LL HH:mm",LLLL:"YYYY-MM-DD HH:mm:ss",ll:"MMM D",lll:"LL HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(e){var t=e%10,i=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i}})}),function(e){"function"==typeof define&&define.amd?define("lang/zh",["moment"],e):"object"==typeof exports?module.exports=e(require("../moment")):e(window.moment)}(function(e){return e.locale("zh",{months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),longDateFormat:{LT:"Ah点mm",L:"YYYY-MM-DD",LL:"YYYY年MMMD日",LLL:"YYYY年MMMD日LT",LLLL:"YYYY-MM-DD HH:mm:ss",l:"YYYY-MM-DD",ll:"MMMD日",lll:"ll HH:mm",llll:"YYYY-MM-DD HH:mm:ss"},meridiem:function(e,t){var i=100*e+t;return 600>i?"凌晨":900>i?"早上":1130>i?"上午":1230>i?"中午":1800>i?"下午":"晚上"},calendar:{sameDay:function(){return 0===this.minutes()?"[今天]Ah[点整]":"[今天]LT"},nextDay:function(){return 0===this.minutes()?"[明天]Ah[点整]":"[明天]LT"},lastDay:function(){return 0===this.minutes()?"[昨天]Ah[点整]":"[昨天]LT"},nextWeek:function(){var t,i;return t=e().startOf("week"),i=this.unix()-t.unix()>=604800?"[下]":"[本]",0===this.minutes()?i+"dddAh点整":i+"dddAh点mm"},lastWeek:function(){var t,i;return t=e().startOf("week"),i=this.unix()<t.unix()?"[上]":"[本]",0===this.minutes()?i+"dddAh点整":i+"dddAh点mm"},sameElse:"LL"},ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"日";case"M":return e+"月";case"w":case"W":return e+"周";default:return e}},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1分钟",mm:"%d分钟",h:"1小时",hh:"%d小时",d:"1天",dd:"%d天",M:"1个月",MM:"%d个月",y:"1年",yy:"%d年"},week:{dow:1,doy:4}})}),function(e){"function"==typeof define&&define.amd?define("lang/ja",["moment"],e):"object"==typeof exports?module.exports=e(require("../moment")):e(window.moment)}(function(e){return e.locale("ja",{months:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"日曜日_月曜日_火曜日_水曜日_木曜日_金曜日_土曜日".split("_"),weekdaysShort:"日_月_火_水_木_金_土".split("_"),weekdaysMin:"日_月_火_水_木_金_土".split("_"),longDateFormat:{LT:"Ah時m分",L:"YYYY/MM/DD",LL:"M月D日",LLL:"M月D日LT",LLLL:"YYYY年M月D日LT dddd"},meridiem:function(e){return 12>e?"午前":"午後"},calendar:{sameDay:"[今日] LT",nextDay:"[明日] LT",nextWeek:"[来週]dddd LT",lastDay:"[昨日] LT",lastWeek:"[前週]dddd LT",sameElse:"L"},relativeTime:{future:"%s後",past:"%s前",s:"数秒",m:"1分",mm:"%d分",h:"1時間",hh:"%d時間",d:"1日",dd:"%d日",M:"1ヶ月",MM:"%dヶ月",y:"1年",yy:"%d年"}})}),define("language",["moment","jquery","i18n","Storage","config/App","semanticui_dropdown"],function(e,t,i,n,a){var r={zh:"zh",ja:"ja"},o={langCodes:{en:"en",en_US:"en",zh:"zh",zh_CN:"zh",zh_SG:"zh",zh_TW:"zh_TW",zh_HK:"zh_TW",ja:"ja",de:"de",ru:"ru",pt:"pt_PT",pt_PT:"pt_PT",pt_BR:"pt_BR",es:"es",es_ES:"es",es_AR:"es_419",es_BO:"es_419",es_CO:"es_419",es_CL:"es_419",es_CR:"es_419",es_DO:"es_419",es_EC:"es_419",es_GT:"es_419",es_HN:"es_419",es_MX:"es_419",es_NI:"es_419",es_PY:"es_419",es_PA:"es_419",es_PE:"es_419",es_PR:"es_419",es_SV:"es_419",es_UY:"es_419",es_VE:"es_419"},langNames:{en:"English",zh:"中文",zh_CN:"中文简体",zh_TW:"中文繁体",ja:"日本語",de:"Deutsch",ru:"Русский язык",pt:"Português",nl:"Nederlands",it:"Italiano",fr:"Français",es:"Español"},lowercase:{en:"en_us",zh:"zh_cn"},init:function(e){this.setDefaultLanguage("component",e)},i18n:function(e){return i.t(e)||i.t(e+".default")||""},_getCurLangCode:function(){return"undefined"!=typeof window.navigator.language?window.navigator.language:window.navigator.browserLanguage},getCurLangCode:function(){var e=this,t=n.get("language");if(t)return t;var i=e.langCodes,a="en_US",r=e._getCurLangCode().replace("-","_");return"undefined"!=typeof i[r]?a=i[r]:r.indexOf("_")>-1&&(r=r.split("_")[0],"undefined"!=typeof i[r]&&(a=i[r])),a},getLowerCase:function(e){return e=e||"en",this.lowercase[e]||"en_us"},getLangName:function(e){return this.langNames[e]},setLanguage:function(i,o,s){var c="/locales/__lng__/__ns__.json?t="+(new Date).getTime();a.isProduct||(c="/front/locales/__lng__/__ns__.json"),i=i||this.getCurLangCode(),n.set("language",i);var u=r[i]||"en";n.set("moment",u),e.locale(u),t.i18n.init({lng:i,resGetPath:c,parseMissingKey:function(){return""},objectTreeKeyHandler:function(){return""},ns:o||"component"},function(){s&&"function"==typeof s&&require(["lang/en","lang/zh","lang/ja"],function(){t("#language-menu").dropdown({action:"select",onChange:function(e){n.set("language",e),window.location.reload()}}),s()})})},setDefaultLanguage:function(e,t){var i=this.getCurLangCode()||"en";this.setLanguage(i,e,t)}};return o}),function(e){"function"==typeof define&&define.amd?define("pnotify.buttons",["jquery","pnotify"],e):e(jQuery,PNotify)}(function(e,t){t.prototype.options.buttons={closer:!0,closer_hover:!0,sticker:!0,sticker_hover:!0,labels:{close:"Close",stick:"Stick"}},t.prototype.modules.buttons={myOptions:null,closer:null,sticker:null,init:function(t,i){var n=this;this.myOptions=i,t.elem.on({mouseenter:function(){!n.myOptions.sticker||t.options.nonblock&&t.options.nonblock.nonblock||n.sticker.trigger("pnotify_icon").css("visibility","visible"),!n.myOptions.closer||t.options.nonblock&&t.options.nonblock.nonblock||n.closer.css("visibility","visible")},mouseleave:function(){n.myOptions.sticker_hover&&n.sticker.css("visibility","hidden"),n.myOptions.closer_hover&&n.closer.css("visibility","hidden")}}),this.sticker=e("<div />",{"class":"ui-pnotify-sticker",css:{cursor:"pointer",visibility:i.sticker_hover?"hidden":"visible"},click:function(){t.options.hide=!t.options.hide,t.options.hide?t.queueRemove():t.cancelRemove(),e(this).trigger("pnotify_icon")}}).bind("pnotify_icon",function(){e(this).children().removeClass(t.styles.pin_up+" "+t.styles.pin_down).addClass(t.options.hide?t.styles.pin_up:t.styles.pin_down)}).append(e("<span />",{"class":t.styles.pin_up,title:i.labels.stick})).prependTo(t.container),(!i.sticker||t.options.nonblock&&t.options.nonblock.nonblock)&&this.sticker.css("display","none"),this.closer=e("<div />",{"class":"ui-pnotify-closer",css:{cursor:"pointer",visibility:i.closer_hover?"hidden":"visible"},click:function(){t.remove(!1),n.sticker.css("visibility","hidden"),n.closer.css("visibility","hidden")}}).append(e("<i />",{"class":t.styles.closer,title:i.labels.close})).prependTo(t.container),(!i.closer||t.options.nonblock&&t.options.nonblock.nonblock)&&this.closer.css("display","none")},update:function(e,t){this.myOptions=t,!t.closer||e.options.nonblock&&e.options.nonblock.nonblock?this.closer.css("display","none"):t.closer&&this.closer.css("display","block"),!t.sticker||e.options.nonblock&&e.options.nonblock.nonblock?this.sticker.css("display","none"):t.sticker&&this.sticker.css("display","block"),this.sticker.trigger("pnotify_icon"),t.sticker_hover?this.sticker.css("visibility","hidden"):e.options.nonblock&&e.options.nonblock.nonblock||this.sticker.css("visibility","visible"),t.closer_hover?this.closer.css("visibility","hidden"):e.options.nonblock&&e.options.nonblock.nonblock||this.closer.css("visibility","visible")}},e.extend(t.styling.jqueryui,{closer:"ui-icon ui-icon-close",pin_up:"ui-icon ui-icon-pin-w",pin_down:"ui-icon ui-icon-pin-s"}),e.extend(t.styling.bootstrap2,{closer:"icon-remove",pin_up:"icon-pause",pin_down:"icon-play"}),e.extend(t.styling.bootstrap3,{closer:"icon remove",pin_up:"glyphicon glyphicon-pause",pin_down:"glyphicon glyphicon-play"}),e.extend(t.styling.fontawesome,{closer:"fa fa-times",pin_up:"fa fa-pause",pin_down:"fa fa-play"})}),define("Logger",["language","jquery","pnotify","app","Storage","pnotify.buttons"],function(e,t,i,n,a){function r(e){function t(e){return e=e||a.get("language")||"en",/en/i.test(e)?"en_us/index.html":"zh_cn/index.html"}var i=window.location.hostname;window.location.href=/^localhost/.test(i)?"/login":"/"+t(e)+"?error=session-expire"}var o={};return o.info=function(t,n){t=n&&1==n.doI18n?e.i18n(t):t||"Info",new i({text:t,type:"info",delay:1e3})},o.warning=function(t,n){t=n&&1==n.doI18n?e.i18n(t):t||"Warning",new i({text:t,type:"warning",delay:3e3})},o.success=function(t,n){t=n&&1==n.doI18n?e.i18n(t):t||"Success",new i({text:t,type:"success",icon:"icon check circle",delay:3e3,mouse_reset:!1,buttons:{closer:!0,closer_hover:!1}})},o.error=function(t,o){var s,c,u;if(t instanceof Error)c="Error",s=t.message;else if(t.statusText||t.status){if(c=t.status,t.status&&(200==t.status||201==t.status))return!1;if(t.responseText)try{var l=JSON.parse(t.responseText);s=l.errorMessage||e.i18n("error.net."+l.errorCode),401==t.status&&(u=a.get("language"),n.User.clearUserData(),r(u))}catch(d){s=t.statusText}else if(0==t.status&&"timeout"==t.statusText)s=e.i18n("error.net.0");else{if(0==t.status&&"abort"==t.statusText)return!1;s=t.status+" "+t.statusText}}else c="Error",s=o&&1==o.doI18n?e.i18n(t):t;new i({title:"error",text:s,type:"error",icon:"icon warning sign",delay:3e3,mouse_reset:!1,buttons:{closer:!0,closer_hover:!1}})},o}),define("U",["app","Storage","Logger","language","underscore","jquery","moment"],function(e,t,i,n,a,r,o){return{Clone:function(e,t){var i=this;if("object"==typeof e){var n=null!=e&&e.sort?[]:{};for(var a in e)a!=t&&(n[a]=i.Clone(e[a],t));return n}return"function"==typeof e?(new e).constructor:e},UC_First:function(e){var t=e.toLowerCase(),i=t.replace(/\b\w+\b/g,function(e){return e.substring(0,1).toUpperCase()+e.substring(1)});return i},jumpTo:function(e){window.location.href=e},changeHash:function(e){e.hash&&(window.location.hash=e.hash),e.reload&&location.reload()},secToHou:function(e){var t=Math.floor(e),i=Math.floor(t/3600),n=Math.floor((t-3600*i)/60),a=t-3600*i-60*n;return{hour:i,minute:n,second:a}},formatAxis:function(e){var i=[];return o.locale(t.get("moment")),a.forEach(e,function(e){if(/^(\d{4})(\d{2})(\d{2})(\d{2})?$/.test(e)){if(RegExp.$4)var t=o(RegExp.$2+"/"+RegExp.$3+" "+RegExp.$4+":00","MM/DD HH:mm").format("lll");else var t=o(RegExp.$2+"/"+RegExp.$3,"MM/DD").format("ll");i.push(t)}else i.push(/^(\d{2})$/.test(e)?RegExp.$1:e)}),i},getLength:function(e){for(var t=0,i=e.length,n=-1,a=0;i>a;a++)n=e.charCodeAt(a),t+=n>=0&&128>=n?1:3;return t},forceRender:function(){var e=document.body;e.style.cssText+=";-webkit-transform:rotateZ(0deg)",e.offsetHeight,e.style.cssText+=";-webkit-transform:none"},isImage:function(e){return e?/^image\//.test(e.type):!1},parseUrl:function(e){return/^(http|https):\/\//.test(e)?e:"https://"+e},strEllip:function(e,t){var i=e.length;if(t>=2*i)return e;t-=3;for(var n=0;i>n&&t>0;)escape(e.charAt(n)).length>4&&t--,t--,n++;return t>0?e:e.substring(0,n)+"..."},ParseError:function(e,t,a,r,o){if(!e||!a||!t)return i.error(n.i18n("error"));try{var s="{"!=e.responseText.charAt(0)?e:JSON.parse(e.responseText);if(s&&(s.errorCode||s.status)){s.errorCode=s.errorCode?s.errorCode:s.status;var c=t+"."+a+"."+s.errorCode,u=t+".error";400!=e.status&&(s.errorMessage="Sever Error  "+s.errorCode),"function"==typeof r?r(e,o):r&&s.errorCode in r?r[s.errorCode](e,o):r&&r["default"]?r["default"](e,o):i.error(n.i18n(c)?n.i18n(c):s.errorMessage?s.errorMessage:n.i18n(u))}else i.error(text)}catch(l){i.error(n.i18n("error"))}},goTo:function(e,t,i){window.location.hash=e+(t?"/"+t:"")+(i?"/"+i:"")},navigateTo:function(t,i,n){e.Router.navigate(t+(i?"/"+i:"")+(n?"/"+n:""))},normalize:function(e){var t={ios:"iOS",android:"Android","app store":"App Store","google play":"Google Play"};return t[e.toLowerCase()]||e},parseCurrentUrl:function(){var e={origin:window.location.origin,pathname:window.location.pathname,module:"dashboard",appId:"",hash:window.location.hash,url:window.location.href},t=e.pathname.match(/^(.*?)\/(\w+)\/?/);t&&t.length>2&&(e.module=t[2]);var i=e.pathname.match(/\/apps\/(\w+)/);return i&&i.length>1&&(e.appId=i[1]),""==e.appId||/\/apps\/(\w+)/.test(window.location.href)||(e.url=e.url.replace(e.module,e.module+"/apps/"+e.appId)),e},getCreditCardFullType:function(e){var t=!1;return/^5[1-5][0-9]{14}$/.test(e)?t="MasterCard":/^4[0-9]{12}(?:[0-9]{3})?$/.test(e)?t="Visa":/^3[47][0-9]{13}$/.test(e)?t="American Express":/^(?:2131|1800|35\d{3})\d{11}$/.test(e)?t="JCB":/^3(?:0[0-5]|[68][0-9])[0-9]{11}$/.test(e)?t="Diners Club":/^6(?:011|5[0-9]{2})[0-9]{12}$/.test(e)&&(t="Discover"),t},getCreditCardType:function(e){var t=!1;return/^5[1-5]/.test(e)?t="mastercard":/^4/.test(e)?t="visa":/^3[47]/.test(e)?t="ae":/^(?:2131|1800|35)/.test(e)?t="jcb":/^3(?:0[0-5]|[68])/.test(e)?t="dinner":/^6(?:011|5)/.test(e)&&(t="discover"),t},getPixelRatio:function(e){var t=e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return(Math.round(window.devicePixelRatio)||1)/t}}}),define("dispatcher",["U","underscore","backbone"],function(e,t,i){var n={};n.on=function(e,t,n,a){var r,o=e.split(".");switch(r=o.length>1?o[0]:"Event"){case"Event":i.Wreqr.radio.channel(a||"global").vent.on(o[1]||o[0],t,n);break;case"Command":i.Wreqr.radio.channel(a||"global").commands.setHandler(o[1],t,n);break;case"Request":i.Wreqr.radio.channel(a||"global").reqres.setHandler(o[1],t,n);break;default:throw new Error("None support Message Type")}};var a=function(e,t){var n,a=t.split(".");switch(n=a.length>1?a[0]:"Event"){case"Event":i.Wreqr.radio.channel(e||"global").vent.off(a[1]||a[0]);break;case"Command":i.Wreqr.radio.channel(e||"global").commands.removeHandler(a[1]);break;case"Request":i.Wreqr.radio.channel(e||"global").reqres.removeHandler(a[1]);break;default:throw new Error("None support Message Type")}};return n.off=function(e,i){t.isArray(i)?t.forEach(i,function(t){a(t,e)}):a(i||"global",e)},n.execute=function(e,n,a){t.isArray(a)?t.forEach(a,function(t){i.Wreqr.radio.channel(t).commands.execute(e,n)}):i.Wreqr.radio.channel(a||"global").commands.execute(e,n)},n.trigger=function(e,n,a){t.isArray(a)?t.forEach(a,function(t){i.Wreqr.radio.channel(t).vent.trigger(e,n)}):i.Wreqr.radio.channel(a||"global").vent.trigger(e,n)},n.request=function(e,t,n){return i.Wreqr.radio.channel(n||"global").reqres.request(e,t)},n}),define("config/User",[],function(){return{AppId:"",SessionToken:"",Timezone:"Asia/Shanghai"}}),define("config/Ajax",[],function(){return{TIMEOUT:2e4,HTTPHEADER:{}}}),define("config/UI",[],function(){return{SlickGrid:{editable:!0,headerRowHeight:46,rowHeight:40,autoEdit:!1,enableCellNavigation:!0,asyncEditorLoading:!1,forceFitColumns:!1},Table:{table_class:"ui single line sortable table",header_class:"",body_class:"",header_cell_class:"",cell_class:"",display_header:!0,row_color:!0}}}),define("config/Filter",[],function(){return{String:[{name:"=",value:"eq"},{name:"!=",value:"ne"},{name:"exists",value:"exists"},{name:"start with",value:"start with"}],Number:[{name:">",value:"gt"},{name:">=",value:"gte"},{name:"<",value:"lt"},{name:"<=",value:"lte"},{name:"=",value:"eq"},{name:"!=",value:"ne"},{name:"exists",value:"exists"},{name:"not exists",value:"not exists"}],Boolean:[{name:"=",value:"eq"},{name:"exists",value:"exists"},{name:"not exists",value:"not exists"}],Date:[{name:"before",value:"before"},{name:"after",value:"after"},{name:"exists",value:"exists"},{name:"not exists",value:"not exists"}],File:[{name:"exists",value:"exists"},{name:"not exists",value:"not exists"}],GeoPoint:[{name:"exists",value:"exists"},{name:"not exists",value:"not exists"}],Array:[{name:"exists",value:"exists"},{name:"not exists",value:"not exists"},{name:"contains value",value:"contains"},{name:"does not contain value",value:"not contains"},{name:"contains one of",value:"in"},{name:"does not contain any of",value:"nin"}],Object:[{name:"exists",value:"exists"},{name:"not exists",value:"not exists"}],Pointer:[{name:"exists",value:"exists"},{name:"not exists",value:"not exists"}],ACL:[{name:"exists",value:"exists"},{name:"not exists",value:"not exists"}]}}),define("C",["config/App","config/User","config/Ajax","config/UI","config/Filter","U"],function(e,t,i,n,a,r){function o(e,t,i){return"undefined"==typeof e[t[i]]?!1:"undefined"!=typeof t[i+1]?o(e[t[i]]||{},t,i+1):e[t[i]]}function s(e,t,i,n){return"undefined"==typeof e[i[n]]&&(e[i[n]]={}),"undefined"==typeof i[n+1]?(e[i[n]]=t,t):void s(e[i[n]]||{},t,i,n+1)}var c={App:e,Ajax:i,User:t,UI:n,Filter:a},u={};return u.set=function(e,t){var i=e.split(".");return s(c,t,i,0)},u.get=function(e,t){var i=e.split("."),n=o(c,i,0);return t?r.Clone(n):n},u}),define("API",["C","U"],function(e){var t={},i=document.location.protocol+"//"+document.location.hostname+(document.location.port?":"+document.location.port:""),n="2.0",a={App:i+"/"+n+"/apps",Data:i+"/"+n+"/",Class:i+"/"+n+"/classes",User:i+"/"+n+"/users",Product:i+"/"+n+"/products",Passport:i+"/"+n+"/passport",Installation:i+"/"+n+"/installations",Role:i+"/"+n+"/roles",OrgUsers:i+"/"+n+"/orgUsers",Users:i+"/"+n+"/",Files:i+"/"+n+"/files",Schema:i+"/"+n+"/schemas",Country:i+"/"+n+"/location/country",Lang:i+"/"+n+"/location/lang",captcha:i+"/"+n+"/captcha/",Email:i+"/"+n+"/",DataIE:i+"/"+n+"/dataie",Pay:i+"/"+n+"/pay",SMS:i+"/"+n+"/sms"},r={EmailTpl:function(){return"apps/"+e.get("User.AppId")+"/emailtemplates"},SingleApp:function(){return"apps/"+e.get("User.AppId")},Schema:function(){return"/schemas/"},Batch:function(){return"/batch/"},Installation:function(){return"/_Installation"},register:function(){return"/register"},requestPasswordReset:function(){return"/requestPasswordReset"},requestEmailVerify:function(){return"/requestEmailVerify"},verifyEmail:function(){return"/verifyEmail"},resetPassword:function(){return"/resetPassword"}};return t.get=function(e){var t=e.split("."),i=a[t[0]];return t[1]?r[t[1]]?i+r[t[1]]():i+"/"+t[1].toLowerCase():i},t}),define("core/functions/UI",["app","dispatcher","U","C","language","i18n","Logger","jquery","underscore","Storage","semanticui_modal","API","semanticui_checkbox"],function(e,t,i,n,a,r,o,s,c,u,l,d){window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(){return-1}}(),window.cancelRequestAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||function(){return-1}}();var m=null;return{showDialog:function(e,i,n){n=n||{},n=s.extend({specialDialogUI:"",btns:{negative:"common.form.cancel",positive:"common.form.apply",others:[]}},n);var a=n.el||s("#app-dialog");a.attr("special-dialog-ui",n.specialDialogUI),a.parent().removeClass("hidden"),a.removeClass("hidden"),a.removeClass("small medium large x-large"),n.size&&a.addClass(n.size);var o=a.find(".header");o.html(e);var u=a.find(".actions");u.html(""),0!=n.footer&&(n.btns.negative&&""!=n.btns.negative&&u.append('<div class="ui button negative">'+r.t(n.btns.negative)+"</div>"),n.btns.positive&&""!=n.btns.positive&&u.append('<div class="ui button primary positive">'+r.t(n.btns.positive)+"</div>"),c.each(n.btns.others,function(e){if("string"==typeof e)u.append('<div class="ui primary button">'+r.t(e)+"</div>");else if("object"==typeof e){var i=r.t(e.name),n=e.className||"",a=s('<div class="ui button">'+i+"</div>");a.addClass(n),e.icon&&a.prepend('<i class="icon '+e.icon+'"></i>'),e.onClick&&a.bind("click",function(){t.trigger("click:"+e.onClick,{},"Component")}),u.append(a)}}));var l=a.find(".content");if(0==l.length&&(o.after('<div class="content"></div>'),l=a.find(".content")),"string"==typeof i)l.html(i);else{var d=new i(c.extend({},{el:a.find(".content")},n));a.data("dialog-view",d),d.init&&d.init(),d.beforeShow&&d.beforeShow(),d.render(n),d.$(".ui.checkbox").length>0&&d.$(".ui.checkbox").checkbox()}var m=c.pick(n,["closable","useCss","transition","duration","easing","allowMultiple","observeChanges","onVisible","onHidden","options"]);m.transition=m.transition||"scale",0==n.closable?(m.closable=!1,a.children(".icon.close").hide()):a.children(".icon.close").show(),m.onApprove=function(){return n&&n.success&&n.success(a.data("dialog-view")),!1},m.onDeny=function(){n&&n.error&&n.error(a.data("dialog-view"))},m.onHidden=function(){a.removeAttr("special-dialog-ui");var e=a.data("dialog-view");e&&(e.$(".ui.checkbox").length>0&&e.$(".ui.checkbox").checkbox("destroy"),e.beforeHide&&e.beforeHide(),e.destroy(),a.data("dialog-view",null)),a.removeClass("hidden"),s(document).off("keyup.dialog")};var p=function(){s(document).on("keyup.dialog",function(e){13==(e.keyCode||e.which)&&m.onApprove()})};if(m.onVisible){var f=m.onVisible;m.onVisible=function(e){f(e),p()}}else m.onVisible=p;n.autofocus||(m.autofocus=!1),a.modal(m).modal("show")},hideDialog:function(e){e=e||{},e.el?e.el.modal("hide").removeClass("hidden"):s("#app-dialog").modal("hide").removeClass("hidden")},bindUploader:function(e,t,n){e.each(function(e,a){var r=s('<input type="file" style="display:none" />').insertAfter(s(a));s(a).on("click",function(){r.trigger("click")}),r.change(t?function(e){var a=new FileReader,r=s(this).get(0).files[0]||{type:""};i.isImage(r)&&(a.readAsDataURL(r),a.onloadend=function(e){s(t).css("opacity",1),s(t).css("background-repeat","no-repeat"),s(t).css("background-image","url("+e.target.result+")")}),n&&n(e)}:function(e){n&&n(e)})})},removeStatus:function(e){s(e).closest(".field").removeClass("success error"),s(e).closest(".field").children(".error-msg").remove()},toggleSuccess:function(e){this.removeStatus(e)},toggleError:function(e,t){this.removeStatus(e),e.closest(".field").addClass("error"),this._showMessage(e,t)},_showMessage:function(e,t){s(e).hasClass("logger-msg")?o.error(r.t(t)):0==s(e).siblings(".error-msg").length?s(e).closest(".field").append('<span class="error-msg"><i class="warning circle icon"></i>'+r.t(t)+"</span>"):s(e).siblings(".error-msg").text(r.t(t))},_visible:function(e){return document.body.scrollTop<e.offset().top},createCaptcha:function(e){function t(){s("body").delegate("#captcha_img","click",function(){var e=s(this);e.attr("src","").css("background","url(images/ajax_loader_mini.gif) no-repeat center center"),i()})}function i(){var t=Math.random();s.ajax({url:d.get("captcha.secret"),type:"get",data:{_:t},dataType:"json"}).done(function(t,i,n){var a=n.getResponseHeader("X-LAS-SECRET");e.find("#captcha_img").attr("src",d.get("captcha")+"?secret="+a).data("HEADER_SECRET",a)}).fail(function(){e.find("#captcha_img").attr("src",""),o.error("prelogin.error.get-captcha",{doI18n:!0})}).always(function(){e.find(".captcha-warpper").show().end().find(".default-text").hide()})}if(e)return i(),t(),{getCaptchaValue:function(){return s("#captcha").val()},getCaptchaHeaderSecret:function(){return s("#captcha_img").data("HEADER_SECRET")},refresh:function(){s("#captcha_img").click()}}},initIconProgress:function(e){var t=s(e).get(0),i=t.getContext("2d");i.save(),i.fillStyle="#000000",i.fillRect(0,0,174,174),i.restore()},startUploadIcon:function(e){var t=s(e).get(0),i=t.getContext("2d");i.save(),i.beginPath(),i.arc(87,87,80,0,2*Math.PI),i.closePath(),i.clip(),i.clearRect(0,0,174,174),i.restore(),this.progressIcon(e,0)},progressIcon:function(e,t){var i=this,n=s(e).data("percent")||0;m&&cancelRequestAnimationFrame(m),i.progressAnimation(e,n,t)},progressAnimation:function(e,t,i){var n=this;t>i&&(t=i);var a=s(e).get(0),r=a.getContext("2d");r.save(),r.beginPath(),r.arc(87,87,80,0,2*Math.PI),r.closePath(),r.clip(),r.clearRect(0,0,174,174),r.restore(),r.fillStyle="#000000",r.beginPath(),r.arc(87,87,80,0,2*Math.PI),r.closePath(),r.stroke(),r.beginPath(),0==t?r.arc(87,87,60,0,2*Math.PI,!0):r.arc(87,87,60,1.5*Math.PI,Math.PI*(2*t/100+1.5),!0),r.lineTo(87,87),r.closePath(),r.fill(),r.restore(),s(e).data("percent",t),i>t?requestAnimationFrame(function(){n.progressAnimation(e,t+1,i)}):100==t&&n.completeIcon(e)},completeIcon:function(e){function t(){a+=2,a>130&&(a=130),n.save(),n.beginPath(),n.arc(87,87,a,0,2*Math.PI),n.closePath(),n.clip(),n.clearRect(0,0,174,174),n.restore(),130>a?requestAnimationFrame(t):s(e).remove()}var i=s(e).get(0),n=i.getContext("2d");m&&cancelRequestAnimationFrame(m);var a=80;requestAnimationFrame(t)},setIntroProps:function(e){s.each(e,function(e,t){t=s.extend(t,{"data-selector":e}),s(e).attr(t)})},initTooltips:function(){s("body").delegate("[data-sem-key]","mouseenter",function(e){s(e.currentTarget).popup(s.extend({},n.get("UI.Popup"),{offset:-10,html:a.i18n(s(e.currentTarget).attr("data-sem-key"))}))})},initScreenNotification:function(){var e=860,t=s("#screen-notification");s(window).bind("resize",function(){s(window).width()<e?t.show():t.hide()}).trigger("resize")},bindLogout:function(){s(".logout").unbind("click.logout").bind("click.logout",function(){e.User.logout()})}}}),define("basic/Object",["underscore"],function(e){function t(){}function i(t,i){var n,a=this;n=t&&e.has(t,"constructor")?t.constructor:function(){return a.apply(this,arguments)},e.extend(n,a,i);var r=function(){this.constructor=n};return r.prototype=a.prototype,n.prototype=new r,t&&e.extend(n.prototype,t),n.__super__=a.prototype,n}return t.create=function(e){var i=new t;return 0==i.initialize(e)?!1:i},t.extend=i,t.prototype.initialize=function(t){return t||(t={}),e.extend(this,t),!0},t.prototype.get=function(e){if(!e)throw new Error("CObject: method get need argument key");return this[e]},t.prototype.set=function(e,t){if(!e)throw new Error("CObject: method set need arguments key");return this[e]=t,this},t.prototype.destroy=function(){return delete this},t}),define("Cookie",[],function(){return{get:function(e){var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));
return null!=t?JSON.parse(decodeURI(t[2])):null},set:function(e,t,i,n){var a=new Date;a.setTime(a.getTime()+24*("undefined"==typeof i?1:i)*60*60*1e3),document.cookie=e+"="+encodeURI(t)+";expires="+a.toGMTString()+";path="+n||"/"},remove:function(e){this.set(e,"",-1)},clear:function(){var e=document.cookie.match(/[^ =;]+(?=\=)/g);if(e)for(var t=e.length;t--;)document.cookie=e[t]+"=0;domain="+window.location.hostname+";path=/;expires="+new Date(0).toUTCString()}}}),define("other/Account",["basic/Object","Cookie","Storage","C","U","jquery","underscore","i18n","semanticui_dropdown"],function(e,t,i,n,a,r,o){var s=[],c=e.extend({initialize:function(e){return this._configure(e),this.syncAccountInfo(),!0},_configure:function(e){this.options&&(e=o.extend({},o.result(this,"options"),e)),this.options=o.pick(e,s)},syncAccountInfo:function(){this.set("username",i.get("username")),this.set("email",i.get("email")),this.set("userType",i.get("userType")),this.set("roleType",i.get("roleType")),/(\w+\.)?(\w+)\./.test(window.location.hostname);var e=RegExp.$1;this.set("userId",t.get(e+"userId")||i.get("userId"))},clearUserData:function(){var e=i.get("lastUrl"),n=i.get("vistedIntrosSelector");i.clear(),t.clear(),e&&i.set("lastUrl",e),n&&i.set("vistedIntrosSelector",n)},logout:function(){this.clearUserData(),a.jumpTo("/login")},renderUserInfo:function(){this.username||this.email||"";r("#user-menu").i18n(),r("#user-menu").dropdown({duration:100,action:"select",onChange:function(e,t,i){console.log(i),console.log(i.find("a")[0]),i.find("a")[0].click()}})},destroy:function(){}});return c.create=function(e){var t=new c;return 0==t.initialize(e)?!1:t},c}),define("other/StateMachine",["basic/Object"],function(e){var t=e.extend({initialize:function(){return this._state={},this._callback={},!0},register:function(e,t,i,n){this._state[e]||(this._state[e]={}),this._state[e][t]=i,this._callback[e]||(this._callback[e]={}),this._callback[e][t]=n},execute:function(e,t){if(!(this.currentState&&this._callback[this.currentState]&&this._state[this.currentState]&&this._state[this.currentState][e]))return!1;var i=this._callback[this.currentState][e];return this.currentState=this._state[this.currentState][e],i?i(t):!1},setState:function(e){this.currentState=e}}),i=new t;return 0==i.initialize()?!1:i}),define("data/Task",["basic/Object","API","Logger","C","Q","jquery","underscore","pace"],function(e,t,i,n,a,r,o,s){var c=["params","method","header","url","timeout","formatter","buffer","next","queryUrl","extractUrl"],u=0,l=1,d=2,m=3,p=e.extend({initialize:function(e){return this._configure(e),this.result={},this.state=u,this.defer=a.defer(),!0},_configure:function(e){this.options&&(e=o.extend({},o.result(this,"options"),e)),this.options=o.pick(e,c)},start:function(){var e,c=this;if(this.state==l)return this.defer.promise;(this.state==d||this.state==m)&&(this.defer=a.defer());var u=this.options.method||"GET",p=this.options.params,f=this.options.url||"";this.options.extractUrl&&(f=t.get(f));var h=this.options.timeout||n.get("Ajax.TIMEOUT"),g=o.extend({},n.get("Ajax.HTTPHEADER"),this.options.header);this.options.queryUrl&&(u="POST",f=this.options.queryUrl);try{e="GET"==u.toUpperCase()?p:JSON.stringify(p)}catch(_){console.log("Task: params format error")}this.state=l,s.restart();var v=r.ajax({url:f,type:u,dataType:"json",contentType:"application/json",data:e,timeout:h,headers:g});return this._ajax=v,a(v).then(function(e){return c.state=d,e},function(e){return i.error(e,c.options),c.state=m,c.options.buffer?c.options.buffer:e.responseText}).then(function(e){if(c.options.formatter&&"function"==typeof c.options.formatter){var t=c.options.formatter(e,c.options);if(t&&a.isPromise(t))return void t.then(function(e){c.result=e,c.defer.resolve(c.result)},function(e){c.result=e,c.defer.resolve(c.result)}).fail(function(){});c.result=t}else c.result=e;c.defer.resolve(c.result)}).fail(function(){}),c.defer.promise},abort:function(){return this._ajax?this._ajax.abort():!1}});return p.create=function(e){var t=new p;return 0==t.initialize(e)?!1:t},p}),define("data/DataRepository",["Logger","basic/Object","data/Task","dispatcher","Q","jquery","underscore"],function(e,t,i,n,a,r,o){var s=[],c=t.extend({initialize:function(e){return this.isRunning=!1,this._configure(e),this._store_list={},!0},_configure:function(e){this.options&&(e=o.extend({},o.result(this,"options"),e)),this.options=o.pick(e,s)},start:function(){this.isRunning=!0},stop:function(){this.isRunning=!1},push:function(e,t){return this.isRunning?void(this._store_list[e]=t):!1},getStore:function(e){return"undefined"==typeof this._store_list[e]?!1:this._store_list[e]},remove:function(e){return"undefined"==typeof this._store_list[e]?!1:delete this._store_list[e]},fetch:function(e,t,i){if("undefined"==typeof this._store_list[e])throw new Error('DataRepository: "'+e+'" is not existed');var n=this._store_list[e];return"string"==typeof t?n.getState(t,i):n.getData()},fetchNew:function(e,t){if("undefined"==typeof this._store_list[e])throw new Error('DataRepository: "'+e+'" is not existed');var i=this._store_list[e];return i.refreshData(t,!0)},refresh:function(t,i){if("undefined"==typeof this._store_list[t])throw new Error('DataRepository: "'+t+'" is not existed');var r=this._store_list[t];try{var o=r.refreshData(i);o&&a.isPromise(o)&&o.done(function(e){console.log('refresh:"'+t+'"'),n.trigger("refresh:"+t,e,"Component")})}catch(s){e.error(s)}return o}});return c.create=function(e){var t=new c;return 0==t.initialize(e)?!1:t},c}),define("net/RequestPool",["basic/Object","jquery","underscore"],function(e,t,i){var n=[],a=e.extend({initialize:function(e){return this._configure(e),this._request_list={},!0},_configure:function(e){this.options&&(e=i.extend({},i.result(this,"options"),e)),this.options=i.pick(e,n)},push:function(e,t){"undefined"==typeof this._request_list[e]&&(this._request_list[e]=[]),this._request_list[e].push(t._ajax)},clear:function(e){e?this._request_list[e]=[]:this._request_list={}},abortByStoreName:function(e){this._request_list[e]&&this._request_list[e].length>0&&(i.forEach(this._request_list[e],function(e){e.abort()}),this._request_list[e]=[])}});return a.create=function(e){var t=new a;return 0==t.initialize(e)?!1:t},window.rp12=a.create(),rp12}),define("data/Store",["app","basic/Object","net/RequestPool","data/Task","U","Q","jquery","underscore"],function(e,t,i,n,a,r,o,s){var c=["generator","usePool","name"],u=1,l=2,d=3,m=t.extend({initialize:function(e){return this._configure(e),this.QUEUE=!1,this._state_list={},this._resultStack=[],this._callbackStack=[],this._currentProgress=0,this.addDefaultState(),e.name&&this.register(e.name),!0},_configure:function(e){this.options&&(e=s.extend({},s.result(this,"options"),e)),this.options=s.pick(e,c)},register:function(t){e.DataRepository.push(t,this)},setData:function(e){var t={};e instanceof n?(t.data=e,t.type="task",e.state=l):(t.data=a.Clone(e),t.type="data"),this._origin_data=t},getTask:function(){var e=this._origin_data.type;return"task"==e?this._origin_data.data:!1},getData:function(){var e=r.defer(),t=this._origin_data.type;if("data"==t)e.resolve(a.Clone(this._origin_data.data));else{var i=this._origin_data.data,n=i.state;if(n==l||n==d)e.resolve(a.Clone(i.result));else{if(n==u)return i.defer.promise;e.reject(new Error("Store: unknown error"))}}return e.promise},addState:function(e,t){this._state_list[e]=t},addDefaultState:function(){this.addState("default",function(e){return e})},getState:function(e,t){if("undefined"==typeof this._state_list[e])throw new Error('State: "'+e+'" is not defined');var i=r.defer(),n=this._state_list[e];return this.getData().done(function(e){var r=n(a.Clone(e),t);r&&r.done?r.done(function(e){i.resolve(e)}):i.resolve(r)}),i.promise},refreshData:function(e,t){var a=this,o=this._origin_data.type;if("data"==o){var c=r.defer();return c.resolve(this._origin_data.data),c.promise}var m=this._origin_data.data,p=this.options.generator?this.options.generator(e||{},m.options):e||{},f=s.extend({},m.options,p),h=m.state;if(t){var g=n.create(f),_=g.start();return this.options.usePool&&i.push(this.options.name,g),_}if(h==u||1==this.QUEUE){if(this.checkEqual(f,m.options)&&0==this.QUEUE)return console.log("equal return same"),!1;console.log("unequal start new"),this.QUEUE=!0,0==this._callbackStack.length&&(this.MAIN_TASK=!1,m.defer.promise.done(function(){a.MAIN_TASK=!0;var e=0;for(console.log("main task clear: T");"undefined"!=typeof a._resultStack[e];)console.log("task call"+e),a._origin_data.data._configure(a._resultStack[e].options),a._origin_data.data.result=a._resultStack[e].result,a._callbackStack[e].resolve(a._resultStack[e].result),a._callbackStack[e]=void 0,e++}));var v=r.defer();v.index=this._callbackStack.length,this._callbackStack.push(v);var A=n.create(f);return A.start().done(function(){console.log("sub task clear:"+v.index),a._currentProgress++,a._resultStack[v.index]=A,a._currentProgress==a._callbackStack.length&&a.MAIN_TASK&&(a._currentProgress=0,s.forEach(a._callbackStack,function(e,t){e&&(console.log("task call"+t),a._origin_data.data._configure(a._resultStack[t].options),a._origin_data.data.result=a._resultStack[t].result,e.resolve(a._resultStack[t].result))}),a._callbackStack=[],a._resultStack=[],a.QUEUE=!1)}),this.options.usePool&&i.push(this.options.name,A),v.promise}if(h==l||h==d){m._configure(f);var y=m.start();return this.options.usePool&&i.push(this.options.name,m),y}},checkEqual:function(e,t){return s.isEqual(e.params,t.params)&&e.method==t.method&&e.url==t.url}});return m.create=function(e){var t=new m;return 0==t.initialize(e||{})?!1:t},m}),define("store/RestStore",["data/Store","data/Task","Q","underscore"],function(e,t,i,n){var a=e.extend({getDataById:function(e,a){var r,a=a||"objectId",o=this._origin_data.data,s=i.defer(),c=this._origin_data.type;if("data"==c)r=n.find(o,function(t){return t[a]==e}),s.resolve(r);else if(r=n.find(o.result,function(t){return t[a]==e}))s.resolve(r);else{var u=o.options.url+"/"+e;t.create({url:u}).start().done(function(e){s.resolve(e)})}return s.promise},addData:function(e){var n=this._origin_data.data,a=i.defer(),r=this._origin_data.type;if("data"==r)throw new Error('RestStore: "add" static data to be implement');var o=t.create({url:n.options.url,method:"post",params:e});return o.start().done(function(e){3!=o.state?a.resolve(e):a.reject(e)}),a.promise},deleteData:function(e){var n=this._origin_data.data,a=i.defer(),r=this._origin_data.type;if("data"==r)throw new Error('RestStore: "delete" static data to be implement');var o=n.options.url+"/"+e,s=t.create({url:o,method:"delete"});return s.start().done(function(e){3!=s.state?a.resolve(e):a.reject(e)}),a.promise},updateData:function(e,a){var r=this._origin_data.data,o=i.defer(),s=this._origin_data.type;if("data"==s){var c=n.find(r,function(t){return t.id==e});n.extend(c,a),o.resolve(c)}else{var u=r.options.url+"/"+e,l=t.create({url:u,method:"put",params:a});l.start().done(function(e){3!=l.state?o.resolve(e):o.reject(e)})}return o.promise}});return a.create=function(e){var t=new a;return 0==t.initialize(e||{})?!1:t},a}),define("text!modules/common/AppList/template.html",[],function(){return'<div class="ui floating dropdown pointing left top button">\n    <span class="text">\n        <img class="ui mini avatar image" src="/images/appicon.svg">\n        <span data-i18n="common.title.choose-app"></span>\n    </span>\n    <i class="dropdown icon"></i>\n    <div class="menu">\n        <div class="ui icon search input">\n            <i class="search icon"></i>\n            <input type="text" name="search" data-i18n="[placeholder]common.placeholder.search">\n        </div>\n        <div class="scrolling menu"></div>\n        <div class="divider"></div>\n        <a class="item create-app" href="/createapp">\n            <i class="plus icon"></i>\n            <span data-i18n="common.title.create-app"></span>\n        </a>\n    </div>\n</div>'}),define("modules/common/AppList/view",["app","C","U","Storage","Logger","dispatcher","core/functions/UI","text!./template.html","marionette","jquery","underscore","i18n","semanticui_dropdown"],function(e,t,i,n,a,r,o,s,c,u,l,d){return c.ItemView.extend({template:l.template(s),events:{"click .scrolling>.item":"changeApp","keyup input":"changeAppByKey"},init:function(){var e=window.location.pathname,t="";/^\/(\w+)(\/?|\/apps\/\w+(\/)?)$/.test(e)&&(t=RegExp.$1);var i=this.options.storeName;this.childTemplate=l.template('            <div class="item" data-name="<%= name %>" data-value="<%= objectId %>" data-link="/'+t+'/apps/<%= objectId %>">                <img class="ui mini avatar image" src="<% if(metadata.icon){ %><%= metadata.icon %><% }else{ %>/images/appicon.svg<% } %>">                <span><%= name %></span>            </div>'),r.on("refresh:"+i,this.renderComponent,this,"Component")},beforeShow:function(){var e=this.options.valueEventName;r.on("Request.getValue:"+e,this.getValue,this,"Component")},beforeHide:function(){var e=this.options.valueEventName;r.off("Request.getValue:"+e,"Component"),this.$(".ui.dropdown").each(function(e,t){u(t).data("moduleDropdown")&&u(t).dropdown("destroy")})},changeAppByKey:function(e){if(13==e.keyCode){var t=u(".scrolling>.item.selected").attr("data-link");i.jumpTo(t)}},changeApp:function(e){if(!u(e.currentTarget).hasClass("disabled")){var t=u(e.currentTarget).attr("data-link");i.jumpTo(t)}},renderDropdown:function(e){var i=[],n=this.childTemplate;l.forEach(e,function(e){i.push(u(n(e)))}),this.$(".scrolling").html(i),this.$el.i18n(),this.$(".ui.dropdown").dropdown({message:{noResults:d.t("common.title.not-found")}});var a=t.get("User.AppId");if(a){var r=l.find(e,function(e){return e.objectId==a});if(r){var o=r.metadata||{},s=o.icon||"/images/appicon.svg";this.setValue(a,r.name,s)}}},renderComponent:function(){var t=this,i=this.options.storeName,n=this.options.stateName;e.DataRepository.fetch(i,n).done(function(e){t.renderDropdown(e)})},render:function(){c.ItemView.prototype.render.call(this),this.renderComponent()},refresh:function(){var t=this.options.storeName;e.DataRepository.refresh(t)},setValue:function(e,t,i){this.$(".ui.dropdown").data("moduleDropdown")||this.$(".ui.dropdown").dropdown(),this.$(".ui.dropdown").dropdown("set text",'<img class="ui mini avatar image" src="'+i+'"><span>'+t+"</span>"),this.$(".ui.dropdown").dropdown("set value",e)},getValue:function(){return this.$(".ui.dropdown").dropdown("get value")}})}),define("tpl!modules/common/NotificationBar/template.html",function(){return function(obj){var __p=[];with(obj||{})__p.push('<a class="toggle-notification" href="javascript:void(0)">    <span class="badge">0</span>    <span class="icomoon icomoon-bell2"></span></a><div class="notification-dropdown" style="display:none">    <div class="ui breadcrumb" style="display: block!important;border-bottom: 0"></div>    <div class="notification-dropdown-content">        <ul class="notification-body">        </ul>        <div class="notification-empty-view">            <div class="notification-empty-view-icon"></div>            <div class="notification-empty-view-text"><span data-i18n="notification.content.nodata"></span></div>        </div>    </div>    <div class="notification-status">        <div class="ui button btn-refresh pull-left">        </div>        <span class="tip-updated" data-i18n="common.tip.update"></span>        <span class="tip-loading" data-i18n="common.tip.loading" style="display: none"></span>    </div></div>');return __p.join("")}}),define("tpl!modules/common/NotificationBar/childTemplate.html",function(){return function(obj){var __p=[];with(obj||{})__p.push('<li class="message">    <a href="/issues#issue/',objectId,'">        <div class="app-icon app-icon-head pull-left"></div>        <div class="pull-right">            <span class="from pull-left">',author,'</span>            <time class="pull-right">',time,'</time>        </div>        <span class="title pull-left" style="margin-left:18px;">',title,"</span>    </a></li>");return __p.join("")}}),define("modules/common/NotificationBar/view",["app","dispatcher","tpl!./template.html","tpl!./childTemplate.html","marionette","jquery","underscore","moment","nicescroll"],function(e,t,i,n,a,r){return a.ItemView.extend({template:i,childTemplate:n,events:{"click .toggle-notification":"toggleDisplay","click .notification-body>li":"toggleClose","click .ui.breadcrumb>.section":"toggleType",click:"cancelClick","click .btn-refresh":"refresh"},init:function(){},beforeShow:function(){},cancelClick:function(e){e.stopPropagation()},toggleClose:function(e){var t=this;this.$(".notification-dropdown").removeClass("open"),this.$(".notification-dropdown").stop(!0,!0).animate({opacity:0},200,"linear",function(){t.$(".notification-dropdown").css("transform","rotateY(180deg)").hide()}),r("body").unbind("click.notification"),e&&e.stopPropagation()},toggleShow:function(e){var t=this;r(".dropdown").removeClass("open"),this.$(".notification-dropdown").addClass("open"),this.$(".notification-dropdown").show(),this.$(".notification-dropdown").stop(!0,!0).animate({opacity:1},{duration:200,step:function(e){r(this).css({transform:"rotateY("+180*(1-e)+"deg)",opacity:e}),t.scrollContent.resize()}}),r("body").unbind("click.notification").bind("click.notification",function(){t.toggleClose()}),e&&e.stopPropagation()},toggleType:function(e){this.type=r(e.currentTarget).attr("data-value"),this.$(".ui.breadcrumb>.section").removeClass("active"),r(e.currentTarget).addClass("active"),this.renderComponent(),e.stopPropagation()},toggleDisplay:function(e){this.$(".notification-dropdown").hasClass("open")?this.toggleClose():this.toggleShow(),e.stopPropagation()},render:function(){a.ItemView.prototype.render.call(this),this.type="msgs",this.scrollContent=this.$(".notification-dropdown-content").niceScroll(),this.refresh()},renderComponent:function(){this.$(".btn-refresh").removeClass("loading"),this.$(".tip-updated, .tip-loading").toggle();var t=this.options.storeName,i=this;e.DataRepository.fetch(t,this.type).done(function(e){i.renderNotificationMsg(e)})},renderNotificationMsg:function(){var e=this;this.refreshTask&&clearTimeout(this.refreshTask),setTimeout(function(){e.refresh()},this.options.refreshInterval||18e4)},refresh:function(){var t=this.options.storeName;e.DataRepository.refresh(t)},beforeHide:function(){}})}),define("Timezone",["jquery","underscore","C","moment","moment-timezone"],function(e,t,i,n){var a={default_format:"llll",default_server_timezone_offset:"0",timezones:{0:"Greenwich",7:"Asia/Bangkok",8:"Asia/Shanghai"},init:function(){this.inited||(n.locale(i.get("moment")),this.timezone=this.getUserTimezone(),this.inited=!0)},getUserTimezone:function(){return i.get("User.Timezone")||"Asia/Shanghai"},getTimezoneOffsetByBrowser:function(){return-(new Date).getTimezoneOffset()/60},getTimezoneOffsetByString:function(e){return parseInt(n().tz(e).format("Z"))},getTimezoneOffset:function(e){return this.init(),e=e||this.timezone,this.getTimezoneOffsetByString(e)},convertTimestampToTimeByTimezone:function(e,t,i,a){if(e&&""!=e){a=a||this.default_format;var r=n.unix(e).format(a);return r}},convertByTimezone:function(e,t,i,a){if(e&&""!=e){this.init(),t=t||this.timezone,a=a||this.default_format;var r=n(e).tz(t),o=r.clone().tz(i).format(a);return o}},parseServerTime:function(e,t,i,n){this.init(),i=i||this.timezone,t=t||this.default_server_timezone_offset;var a=this.timezones[t];return this.convertByTimezone(e,a,i,n)},buildServerTime:function(e,t,i,n){this.init(),i=i||this.timezone,t=t||this.default_server_timezone_offset;var a=this.timezones[t];return this.convertByTimezone(e,i,a,n)},handlerTimeProperties:function(e,i,n){var a=this;e&&0!=e.length&&i&&0!=i.length&&(a.init(),n=n||{},n.server_timezone_offset=n.server_timezone_offset||a.default_server_timezone_offset,n.user_timezone=n.user_timezone||a.timezone,n.format=n.format||a.default_format,t.each(e,function(e){t.each(i,function(i){t.has(e,i)&&(e[i]=a.parseServerTime(e[i],n.server_timezone_offset,n.user_timezone,n.format))})}))},handlerTimePropertiesNoFormat:function(e,i){e&&0!=e.length&&i&&0!=i.length&&t.each(e,function(e){t.each(i,function(i){t.has(e,i)&&(e[i]=1e3*n.tz(e[i],"Greenwich").unix())})})},Convert2LocalTime:function(t,i){if(!e.isNumeric(t))throw new Error("must be timestamp");var a=n.tz(t,"Greenwich"),r=a.clone().tz(this.getUserTimezone());return 0==i?r:"undefined"!=typeof i?r.format(i):1e3*r.unix()}};return a}),define("modules/common/Contact",["jquery","Logger","language"],function(e,t,i){"zh"===i.getCurLangCode()?(window.jsI18nData={formValidation:{user:{loginid:"请输入合法的邮箱",email:"请输入合法的邮箱",username:"用户名不能少于6位",password:"密码不能少于8位",name:"请输入公司名称",phone:"请输入合法电话号码",captcha:"请输入验证码","password-confirm":"请确认您的密码","password-same":"两次输入的密码必须相同"},contact:{email:"请输入合法的邮箱",message:"请输入您的反馈信息"}},aboutus:{"send-success":"谢谢您的反馈，我们已经收到您的信息，会尽快与您联系。","send-fail":"发送失败，请稍后再试。"},updatebrowser:"为了您极致的体验，请使用IE11或其他现代浏览器。","get-captcha-error":"获取验证码失败，请稍后重试。","server-error":"服务器异常，请稍后重试。","signout-success":"注销成功"},window.jsI18nData.module={analytics:"分析",segments:"用户群细分",clouddata:"云数据",cloudconfig:"云配置",cloudcode:"云代码",push:"推送",support:"支持",gamemaster:"管理",devcenter:"开发者中心",dashboard:"概况",marketing:"营销推广",appsettings:"设置",gamesettings:"设置",users:"用户",createapp:"创建应用程序",creategame:"创建应用程序"},e(".side-contact-article-en").remove()):(window.jsI18nData={formValidation:{user:{loginid:"Please enter a valid email",email:"Please enter a valid email",username:"User name cannot less than 6",password:"Password cannot less than 8",name:"Please enter orgnization name",phone:"Please input a valid number",captcha:"Please input a valid captcha","password-confirm":"Please confirm your password","password-same":"Two passwords must be the same"},contact:{email:"Please enter a valid email",message:"Please enter your message"}},aboutus:{"send-success":"Thanks for contacting us. We have received your message. Our support will get back to you as soon as possible.","send-fail":"Send fail, please try again latter."},updatebrowser:"In order to make your experience excellent, please use IE11 or other modern browsers.","get-captcha-error":"Get captcha fail, please try later.","server-error":"Server error.","signout-success":"Sign out success"},window.jsI18nData.module={analytics:"Analytics",segments:"Segments",clouddata:"Cloud Data",cloudconfig:"Cloud Config",cloudcode:"Cloud Code",push:"Push",support:"Support",gamemaster:"Master",devcenter:"Dev Center",dashboard:"Dashboard",marketing:"Marketing",appsettings:"Settings",gamesettings:"Settings",users:"Users",createapp:"Create App",creategame:"Create App"},e(".side-contact-article-zh").remove());var n={EMAIL:{SENDAPI:"/2.0/mails/sendmail",SENDTO:["support@leap.as"],DOMAIN:"mercury-browser.com"}},a=function(){function t(t,i,n){e(".validate_msg",t).remove(),t.removeClass("field-error"),n||(t.append('<div class="validate_msg"><i class="icomoon-attention-circled"></i>'+i+"</div>"),t.addClass("field-error"))}function i(i,n){var a=i.attr("name"),r=e.trim(i.val()),o=i.closest(".field"),s=!0,c="";if(o.hasClass("rpassword")){var u=e.trim(o.closest("form").find(".password input").val()),l=e.trim(i.val());""===l?(c=jsI18nData.formValidation.user["password-confirm"],s=!1):l!==u&&(c=jsI18nData.formValidation.user["password-same"],s=!1)}else{var d=n[a];if(void 0===d)return;c=d.msg;var m=d.rule;s="function"==typeof m?m(r):m.test(r)}t(o,c,s)}function n(t,n){return e("input, textarea",t).each(function(t,a){i(e(a),n)}),0===e(".field-error:visible",t).length?!0:!1}var a={from:{rule:function(e){return e.length?/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(e):!0},msg:jsI18nData.formValidation.contact.email},text:{rule:function(e){return e.length>0},msg:jsI18nData.formValidation.contact.message}};return{contactFormRules:a,validateInput:i,validateForm:n}}(),r=function(){function i(){e(".close",s).bind("click",function(){s.slideOut()})}function r(){c.bind("click",function(){s.slideIn()}),o(e("form",s),e(".send-msg-btn",s)),i()}function o(i,r){i.delegate("input","keypress",function(e){return 13===e.keyCode?!1:void 0}),i.delegate("input, textarea","keyup",function(){a.validateInput(e(this),a.contactFormRules)}),r.bind("click",function(){var o=a.validateForm(i,a.contactFormRules),c={};o&&(e(i.serializeArray()).each(function(t,i){c[i.name]=e.trim(i.value)}),c=e.extend(c,{to:n.EMAIL.SENDTO,domain:n.EMAIL.DOMAIN}),c.from=c.from||"Anonymity",e.ajax({method:"POST",url:n.EMAIL.SENDAPI,data:JSON.stringify(c),contentType:"application/json",dataType:"json",beforeSend:function(){r.addClass("loading")},complete:function(){r.removeClass("loading"),s.slideOut()},success:function(){t.success(jsI18nData.aboutus["send-success"])},error:function(){t.error(jsI18nData.aboutus["send-fail"])}}))})}var s=e("#side-contact-article"),c=e("#side-contact-btn");return s.slideOut=function(){this.removeClass("visible")},s.slideIn=function(){this.addClass("visible")},{initContactBtn:r,initFormOp:o}}();r.initContactBtn()}),define("modules/common/bootstrapper",["app","language","dispatcher","core/functions/UI","other/Account","other/StateMachine","data/DataRepository","store/RestStore","data/Task","./AppList/view","./NotificationBar/view","API","U","C","Q","jquery","Storage","Cookie","underscore","moment","semanticui_popup","i18n","Timezone","./Contact"],function(e,t,i,n,a,r,o,s,c,u,l,d,m,p,f,h,g,_,v,A,y,b){function w(e){e&&(p.set("User.AppId",e),g.set("current_app_id",e))}function k(){if(!e.User)throw new Error("You should initialize Account first");e.User.logout()}function T(){var e=Z.module;"dashboard"!=e&&m.jumpTo("/nopermission")}function E(t){e.User.set("permissions",["DASHBOARD","DEV_CENTER","SETTINGS","ORG_PROFILE"]),e.User.set("orgId",t.orgId),e.User.set("roles",t.roles),e.User.set("timezone",t.timezone),e.User.set("email",t.email),e.User.set("username",t.username),e.User.set("userType",t.userType),e.User.set("orgId",t.orgId),g.get("language")||g.set("language",t.language)}function C(){e.DataRepository.fetch("Store:UserProfile").done(function(e){if(e.orgId){E(e);var t=(Z.module,!0);r.execute(t?"has_permission":"no_permission")}else r.execute("no_session_token")},function(){throw new Error("ServerError")})}function S(){var e=Z.module,t=-1!=h.inArray(e,W)?"not_need_app_list":"need_app_list";r.execute(t)}function x(){var t=c.create({url:d.get("OrgUsers")+"/"+e.User.get("userId"),formatter:function(e){return e},method:"GET",buffer:{}}),i=c.create({url:d.get("App"),formatter:function(e){return v.isArray(e)?e.sort(function(e,t){return e.name>t.name?1:-1}):[]},method:"GET",buffer:[]}),n=s.create({name:"Store:AllAppList"});n.setData(i),n.refreshData();var a=s.create({name:"Store:UserProfile"});a.setData(t),a.refreshData()}function j(){}function M(){e.DataRepository.fetch("Store:AllAppList").done(function(e){r.execute("load_success",e)},function(){r.execute("load_fail"),O.reject()})}function P(e){if(h.isArray(e)&&e.length){var t,i=p.get("User.AppId");if(!(t=v.findWhere(e,{objectId:i}))){if(!e[0]||!e[0].objectId)throw new Error("Dirty Data in AppList");i=e[0].objectId,t=e[0]}p.set("User.AppIcon",t.metadata?t.metadata.icon:""),p.set("User.AppName",t.name?t.name:""),w(i),r.execute("in_app_list")}else r.execute("not_in_app_list")}function q(e){r.execute("can_create",e)}function I(){N(),e.User.renderUserInfo(),h("#main-sidebar,#header-nav,#main-container,#main-container>.sidebar").i18n(),n.initTooltips(),n.initScreenNotification(),n.bindLogout(),h("#common-loader").fadeOut(),O.resolve()}function D(){I();var e=new u({storeName:"Store:AllAppList"});e.init(),e.setElement(document.getElementById("app-selector")),e.beforeShow(),e.render()}function L(){D(),h("#app-selector .create-app").remove()}function z(){var t=Z.module;"createapp"==t||"dashboard"==t&&2==e.User.get("userType")?T():(I(),h("#create_app").remove())}function U(){var e=Z.module;g.set("pagebeforecreateapp",e),m.jumpTo("/createapp")}function R(){r.setState("EnterPage"),r.register("EnterPage","no_session_token","NotLogin",k),r.register("EnterPage","expire_session_token","NotLogin",k),r.register("EnterPage","has_session_token","Login",C),r.register("Login","no_session_token","NotLogin",k),r.register("Login","no_permission","NoPermission",T),r.register("Login","has_permission","HasPermission",S),r.register("HasPermission","need_app_list","StartLoadingList",M),r.register("HasPermission","not_need_app_list","NotNeedApp",q),r.register("NotNeedApp","can_create","StartPage",I),r.register("NotNeedApp","can_not_create","StartPage",z),r.register("StartLoadingList","load_success","LoadingComplete",q),r.register("StartLoadingList","load_fail","LoadingError",j),r.register("LoadingComplete","can_create","CanCreate",P),r.register("CanCreate","not_in_app_list","NoApp",U),r.register("CanCreate","in_app_list","StartPage",D),r.register("LoadingComplete","can_not_create","CanNotCreate",P),r.register("CanNotCreate","not_in_app_list","NoPermission",T),r.register("CanNotCreate","in_app_list","NoPermission",L)}function N(){var t=h("#module-menu .menu-content"),i=Z.module,n=e.User.get("permissions"),a=[];if(v.forEach(H,function(e){if(h.inArray(J[e],n)>-1){var t=V[e]?V[e]:e,i=h('<li><a href="/'+e+'"><i class="icomoon '+F[e]+'"></i><span data-i18n="common.module.'+B(t)+'"></span></a></li>');if("userpermission"!=e&&"billing"!=e&&"orgprofile"!=e&&"subscription"!=e)a.push(i);else{var r='<div class="item"><a href="/'+e+'"><i class="'+Y[e]+'"></i><span data-i18n="common.module.'+B(t)+'"></span></a></div>';h(r).insertBefore(h("#user-menu .profile"))}}}),"dashboard"==i){v.forEach(a,function(e,t){0!=e.find("a[href='/dashboard'],a[href='/userpermission'],a[href='/billing']").length&&(a[t]="")}),h('<ul class="app-list app-menu-items"></ul>').insertBefore(h("#create_app_warpper")).append(a);for(var r=8-h("ul.app-menu-items>li").length,o=0;r>o;o++)h("ul.app-menu-items").append('<li class="empty"></li>');h("#header-nav").append('<div class=" page-title">'+b.t("common.module.dashboard")+"</div>")}else h('<ul class="app-list app-menu-items"></ul>').appendTo(t).append(a);h("#module-menu>.icomoon-menu").on("click.appmenu",function(e){function i(){h(document).off("click.appmenu"),t.removeClass("active")}t.hasClass("active")?i():(t.addClass("active"),e.stopPropagation(),h(document).on("click.appmenu",i),h(document).on("click.appmenu","#module-menu",function(e){e.stopPropagation()}))})}function B(e){return"settings"==e?"app-settings":e}function $(){function e(){var e=m.parseCurrentUrl();e&&g.set("lastUrl",e)}var t=g.get("lastUrl");if(Z&&""==Z.hash&&t&&""!=t.hash&&""!=Z.module&&Z.module==t.module&&h.inArray(Z.module.toLowerCase(),K)>-1){var i="";if(/^#(\w+)\//.test(t.hash)){var n=RegExp.$1;"analytics"==t.module&&"funnels"==n&&(n="conversions"),t.hash="#"+n}i=""!=Z.appId?Z.origin+"/"+Z.module+"/apps/"+Z.appId+"/"+t.hash:Z.origin+"/"+Z.module+t.hash,""!=i&&m.jumpTo(i)}else e(),window.onhashchange=function(){e()}}function G(){var e=g.get("current_app_id"),t=g.get("moment");p.set("moment",t),e&&p.set("User.AppId",e),/(\w+\.)?(\w+)\./.test(window.location.hostname);var i=RegExp.$1,n=_.get(i+"sessionToken")||g.get("sessionToken");n&&p.set("User.SessionToken",n);var a=g.get("timezone");a&&p.set("User.Timezone",a);var r=window.location.pathname;/^\/\w+\/apps\/(\w+)(\/)?$/.test(r)&&w(RegExp.$1)}var O=f.defer(),H=["clouddata","settings"],Y={userpermission:"icomoon icomoon-useradm",orgprofile:"icomoon icomoon-orgprofile"},F={dashboard:"dashboard",clouddata:"icomoon-devcenter",settings:"icomoon-setting",profile:"icomoon-useri",orgprofile:"icomoon-orgprofile"},V={clouddata:"dev-center"},W=["dashboard","profile","createapp","product"],K=["settings"],J={dashboard:"DASHBOARD",clouddata:"DEV_CENTER",settings:"SETTINGS",orgprofile:"ORG_PROFILE"},Z=m.parseCurrentUrl();return{init:function(){return $(),e.DataRepository=o.create(),e.DataRepository.start(),e.User=a.create(),t.init(function(){var e=Z.module,t=V[e]?V[e]:e;if(h("#main-toolbar>.module-name").html('<div class="group-name" data-i18n="common.module.'+B(t)+'"></div><div class="menu-name"></div>'),G(),R(),p.get("User.SessionToken")){var i=p.get("User.SessionToken");
i&&p.set("Ajax.HTTPHEADER.X-LAS-Session-Token",i),x(),r.execute("has_session_token")}else r.execute("no_session_token");h("#main-sidebar>.list>a").click(function(e){var t=h(e.currentTarget).attr("data-value"),i=h("#main-container>.sidebar li[data-module="+t+"]");i.length&&(window.location.hash=i.eq(0).children("a").attr("href"))})}),O.promise}}}),define("tpl!config/timezone.json",function(){return function(obj){var __p=[];with(obj||{})__p.push('["Africa/Abidjan", "Africa/Accra", "Africa/Addis_Ababa", "Africa/Algiers", "Africa/Asmara", "Africa/Asmera", "Africa/Bamako", "Africa/Bangui", "Africa/Banjul", "Africa/Bissau", "Africa/Blantyre", "Africa/Brazzaville", "Africa/Bujumbura", "Africa/Cairo", "Africa/Casablanca", "Africa/Ceuta", "Africa/Conakry", "Africa/Dakar", "Africa/Dar_es_Salaam", "Africa/Djibouti", "Africa/Douala", "Africa/El_Aaiun", "Africa/Freetown", "Africa/Gaborone", "Africa/Harare", "Africa/Johannesburg", "Africa/Juba", "Africa/Kampala", "Africa/Khartoum", "Africa/Kigali", "Africa/Kinshasa", "Africa/Lagos", "Africa/Libreville", "Africa/Lome", "Africa/Luanda", "Africa/Lubumbashi", "Africa/Lusaka", "Africa/Malabo", "Africa/Maputo", "Africa/Maseru", "Africa/Mbabane", "Africa/Mogadishu", "Africa/Monrovia", "Africa/Nairobi", "Africa/Ndjamena", "Africa/Niamey", "Africa/Nouakchott", "Africa/Ouagadougou", "Africa/Porto-Novo", "Africa/Sao_Tome", "Africa/Timbuktu", "Africa/Tripoli", "Africa/Tunis", "Africa/Windhoek", "America/Adak", "America/Anchorage", "America/Anguilla", "America/Antigua", "America/Araguaina", "America/Argentina/Buenos_Aires", "America/Argentina/Catamarca", "America/Argentina/ComodRivadavia", "America/Argentina/Cordoba", "America/Argentina/Jujuy", "America/Argentina/La_Rioja", "America/Argentina/Mendoza", "America/Argentina/Rio_Gallegos", "America/Argentina/Salta", "America/Argentina/San_Juan", "America/Argentina/San_Luis", "America/Argentina/Tucuman", "America/Argentina/Ushuaia", "America/Aruba", "America/Asuncion", "America/Atikokan", "America/Atka", "America/Bahia", "America/Bahia_Banderas", "America/Barbados", "America/Belem", "America/Belize", "America/Blanc-Sablon", "America/Boa_Vista", "America/Bogota", "America/Boise", "America/Buenos_Aires", "America/Cambridge_Bay", "America/Campo_Grande", "America/Cancun", "America/Caracas", "America/Catamarca", "America/Cayenne", "America/Cayman", "America/Chicago", "America/Chihuahua", "America/Coral_Harbour", "America/Cordoba", "America/Costa_Rica", "America/Creston", "America/Cuiaba", "America/Curacao", "America/Danmarkshavn", "America/Dawson", "America/Dawson_Creek", "America/Denver", "America/Detroit", "America/Dominica", "America/Edmonton", "America/Eirunepe", "America/El_Salvador", "America/Ensenada", "America/Fort_Wayne", "America/Fortaleza", "America/Glace_Bay", "America/Godthab", "America/Goose_Bay", "America/Grand_Turk", "America/Grenada", "America/Guadeloupe", "America/Guatemala", "America/Guayaquil", "America/Guyana", "America/Halifax", "America/Havana", "America/Hermosillo", "America/Indiana/Indianapolis", "America/Indiana/Knox", "America/Indiana/Marengo", "America/Indiana/Petersburg", "America/Indiana/Tell_City", "America/Indiana/Vevay", "America/Indiana/Vincennes", "America/Indiana/Winamac", "America/Indianapolis", "America/Inuvik", "America/Iqaluit", "America/Jamaica", "America/Jujuy", "America/Juneau", "America/Kentucky/Louisville", "America/Kentucky/Monticello", "America/Knox_IN", "America/Kralendijk", "America/La_Paz", "America/Lima", "America/Los_Angeles", "America/Louisville", "America/Lower_Princes", "America/Maceio", "America/Managua", "America/Manaus", "America/Marigot", "America/Martinique", "America/Matamoros", "America/Mazatlan", "America/Mendoza", "America/Menominee", "America/Merida", "America/Metlakatla", "America/Mexico_City", "America/Miquelon", "America/Moncton", "America/Monterrey", "America/Montevideo", "America/Montreal", "America/Montserrat", "America/Nassau", "America/New_York", "America/Nipigon", "America/Nome", "America/Noronha", "America/North_Dakota/Beulah", "America/North_Dakota/Center", "America/North_Dakota/New_Salem", "America/Ojinaga", "America/Panama", "America/Pangnirtung", "America/Paramaribo", "America/Phoenix", "America/Port-au-Prince", "America/Port_of_Spain", "America/Porto_Acre", "America/Porto_Velho", "America/Puerto_Rico", "America/Rainy_River", "America/Rankin_Inlet", "America/Recife", "America/Regina", "America/Resolute", "America/Rio_Branco", "America/Rosario", "America/Santa_Isabel", "America/Santarem", "America/Santiago", "America/Santo_Domingo", "America/Sao_Paulo", "America/Scoresbysund", "America/Shiprock", "America/Sitka", "America/St_Barthelemy", "America/St_Johns", "America/St_Kitts", "America/St_Lucia", "America/St_Thomas", "America/St_Vincent", "America/Swift_Current", "America/Tegucigalpa", "America/Thule", "America/Thunder_Bay", "America/Tijuana", "America/Toronto", "America/Tortola", "America/Vancouver", "America/Virgin", "America/Whitehorse", "America/Winnipeg", "America/Yakutat", "America/Yellowknife", "Antarctica/Casey", "Antarctica/Davis", "Antarctica/DumontDUrville", "Antarctica/Macquarie", "Antarctica/Mawson", "Antarctica/McMurdo", "Antarctica/Palmer", "Antarctica/Rothera", "Antarctica/South_Pole", "Antarctica/Syowa", "Antarctica/Troll", "Antarctica/Vostok", "Arctic/Longyearbyen", "Asia/Aden", "Asia/Almaty", "Asia/Amman", "Asia/Anadyr", "Asia/Aqtau", "Asia/Aqtobe", "Asia/Ashgabat", "Asia/Ashkhabad", "Asia/Baghdad", "Asia/Bahrain", "Asia/Baku", "Asia/Bangkok", "Asia/Beirut", "Asia/Bishkek", "Asia/Brunei", "Asia/Calcutta", "Asia/Chita", "Asia/Choibalsan", "Asia/Chongqing", "Asia/Chungking", "Asia/Colombo", "Asia/Dacca", "Asia/Damascus", "Asia/Dhaka", "Asia/Dili", "Asia/Dubai", "Asia/Dushanbe", "Asia/Gaza", "Asia/Harbin", "Asia/Hebron", "Asia/Ho_Chi_Minh", "Asia/Hong_Kong", "Asia/Hovd", "Asia/Irkutsk", "Asia/Istanbul", "Asia/Jakarta", "Asia/Jayapura", "Asia/Jerusalem", "Asia/Kabul", "Asia/Kamchatka", "Asia/Karachi", "Asia/Kashgar", "Asia/Kathmandu", "Asia/Katmandu", "Asia/Khandyga", "Asia/Kolkata", "Asia/Krasnoyarsk", "Asia/Kuala_Lumpur", "Asia/Kuching", "Asia/Kuwait", "Asia/Macao", "Asia/Macau", "Asia/Magadan", "Asia/Makassar", "Asia/Manila", "Asia/Muscat", "Asia/Nicosia", "Asia/Novokuznetsk", "Asia/Novosibirsk", "Asia/Omsk", "Asia/Oral", "Asia/Phnom_Penh", "Asia/Pontianak", "Asia/Pyongyang", "Asia/Qatar", "Asia/Qyzylorda", "Asia/Rangoon", "Asia/Riyadh", "Asia/Saigon", "Asia/Sakhalin", "Asia/Samarkand", "Asia/Seoul", "Asia/Shanghai", "Asia/Singapore", "Asia/Srednekolymsk", "Asia/Taipei", "Asia/Tashkent", "Asia/Tbilisi", "Asia/Tehran", "Asia/Tel_Aviv", "Asia/Thimbu", "Asia/Thimphu", "Asia/Tokyo", "Asia/Ujung_Pandang", "Asia/Ulaanbaatar", "Asia/Ulan_Bator", "Asia/Urumqi", "Asia/Ust-Nera", "Asia/Vientiane", "Asia/Vladivostok", "Asia/Yakutsk", "Asia/Yekaterinburg", "Asia/Yerevan", "Atlantic/Azores", "Atlantic/Bermuda", "Atlantic/Canary", "Atlantic/Cape_Verde", "Atlantic/Faeroe", "Atlantic/Faroe", "Atlantic/Jan_Mayen", "Atlantic/Madeira", "Atlantic/Reykjavik", "Atlantic/South_Georgia", "Atlantic/St_Helena", "Atlantic/Stanley", "Australia/ACT", "Australia/Adelaide", "Australia/Brisbane", "Australia/Broken_Hill", "Australia/Canberra", "Australia/Currie", "Australia/Darwin", "Australia/Eucla", "Australia/Hobart", "Australia/LHI", "Australia/Lindeman", "Australia/Lord_Howe", "Australia/Melbourne", "Australia/NSW", "Australia/North", "Australia/Perth", "Australia/Queensland", "Australia/South", "Australia/Sydney", "Australia/Tasmania", "Australia/Victoria", "Australia/West", "Australia/Yancowinna", "Brazil/Acre", "Brazil/DeNoronha", "Brazil/East", "Brazil/West", "CET", "CST6CDT", "Canada/Atlantic", "Canada/Central", "Canada/East-Saskatchewan", "Canada/Eastern", "Canada/Mountain", "Canada/Newfoundland", "Canada/Pacific", "Canada/Saskatchewan", "Canada/Yukon", "Chile/Continental", "Chile/EasterIsland", "Cuba", "EET", "EST", "EST5EDT", "Egypt", "Eire", "Etc/GMT+0", "Etc/GMT+1", "Etc/GMT+10", "Etc/GMT+11", "Etc/GMT+12", "Etc/GMT+2", "Etc/GMT+3", "Etc/GMT+4", "Etc/GMT+5", "Etc/GMT+6", "Etc/GMT+7", "Etc/GMT+8", "Etc/GMT+9", "Etc/GMT-0", "Etc/GMT-1", "Etc/GMT-10", "Etc/GMT-11", "Etc/GMT-12", "Etc/GMT-13", "Etc/GMT-14", "Etc/GMT-2", "Etc/GMT-3", "Etc/GMT-4", "Etc/GMT-5", "Etc/GMT-6", "Etc/GMT-7", "Etc/GMT-8", "Etc/GMT-9", "Etc/GMT", "Etc/GMT0", "Etc/Greenwich", "Etc/UCT", "Etc/UTC", "Etc/Universal", "Etc/Zulu", "Europe/Amsterdam", "Europe/Andorra", "Europe/Athens", "Europe/Belfast", "Europe/Belgrade", "Europe/Berlin", "Europe/Bratislava", "Europe/Brussels", "Europe/Bucharest", "Europe/Budapest", "Europe/Busingen", "Europe/Chisinau", "Europe/Copenhagen", "Europe/Dublin", "Europe/Gibraltar", "Europe/Guernsey", "Europe/Helsinki", "Europe/Isle_of_Man", "Europe/Istanbul", "Europe/Jersey", "Europe/Kaliningrad", "Europe/Kiev", "Europe/Lisbon", "Europe/Ljubljana", "Europe/London", "Europe/Luxembourg", "Europe/Madrid", "Europe/Malta", "Europe/Mariehamn", "Europe/Minsk", "Europe/Monaco", "Europe/Moscow", "Europe/Nicosia", "Europe/Oslo", "Europe/Paris", "Europe/Podgorica", "Europe/Prague", "Europe/Riga", "Europe/Rome", "Europe/Samara", "Europe/San_Marino", "Europe/Sarajevo", "Europe/Simferopol", "Europe/Skopje", "Europe/Sofia", "Europe/Stockholm", "Europe/Tallinn", "Europe/Tirane", "Europe/Tiraspol", "Europe/Uzhgorod", "Europe/Vaduz", "Europe/Vatican", "Europe/Vienna", "Europe/Vilnius", "Europe/Volgograd", "Europe/Warsaw", "Europe/Zagreb", "Europe/Zaporozhye", "Europe/Zurich", "GB-Eire", "GB", "GMT+0", "GMT-0", "GMT", "GMT0", "Greenwich", "HST", "Hongkong", "Iceland", "Indian/Antananarivo", "Indian/Chagos", "Indian/Christmas", "Indian/Cocos", "Indian/Comoro", "Indian/Kerguelen", "Indian/Mahe", "Indian/Maldives", "Indian/Mauritius", "Indian/Mayotte", "Indian/Reunion", "Iran", "Israel", "Jamaica", "Japan", "Kwajalein", "Libya", "MET", "MST", "MST7MDT", "Mexico/BajaNorte", "Mexico/BajaSur", "Mexico/General", "NZ-CHAT", "NZ", "Navajo", "PRC", "PST8PDT", "Pacific/Apia", "Pacific/Auckland", "Pacific/Bougainville", "Pacific/Chatham", "Pacific/Chuuk", "Pacific/Easter", "Pacific/Efate", "Pacific/Enderbury", "Pacific/Fakaofo", "Pacific/Fiji", "Pacific/Funafuti", "Pacific/Galapagos", "Pacific/Gambier", "Pacific/Guadalcanal", "Pacific/Guam", "Pacific/Honolulu", "Pacific/Johnston", "Pacific/Kiritimati", "Pacific/Kosrae", "Pacific/Kwajalein", "Pacific/Majuro", "Pacific/Marquesas", "Pacific/Midway", "Pacific/Nauru", "Pacific/Niue", "Pacific/Norfolk", "Pacific/Noumea", "Pacific/Pago_Pago", "Pacific/Palau", "Pacific/Pitcairn", "Pacific/Pohnpei", "Pacific/Ponape", "Pacific/Port_Moresby", "Pacific/Rarotonga", "Pacific/Saipan", "Pacific/Samoa", "Pacific/Tahiti", "Pacific/Tarawa", "Pacific/Tongatapu", "Pacific/Truk", "Pacific/Wake", "Pacific/Wallis", "Pacific/Yap", "Poland", "Portugal", "ROC", "ROK", "Singapore", "Turkey", "UCT", "US/Alaska", "US/Aleutian", "US/Arizona", "US/Central", "US/East-Indiana", "US/Eastern", "US/Hawaii", "US/Indiana-Starke", "US/Michigan", "US/Mountain", "US/Pacific-New", "US/Pacific", "US/Samoa", "UTC", "Universal", "W-SU", "WET", "Zulu"]');return __p.join("")}}),define("config/validate",["jquery"],function(e){return{required:{msg:"error.format.required",validator:function(t){return e.trim(t)&&null!=typeof t}},appname:{regex:/^[a-zA-Z0-9]+[0-9a-zA-Z_-\s\u4e00-\u9fa5]{1,}$/,msg:"error.format.appname",rules:["required"]},columnname:{regex:/^[A-Za-z_][A-Za-z0-9_]*$/,msg:"error.format.columnname",rules:["required"]},targetclass:{msg:"error.local.targetclass",validator:function(e,t){var i=t.type,n=t.target;return!(("Pointer"==i||"Relation"==i)&&!n)}},eid:{regex:/^[A-Za-z][A-Za-z0-9]+$/,msg:"error.format.appname",rules:["required"]},url:{regex:/^((http|https):\/\/(.*))?$/,msg:"error.format.url"},urlpathAndNotEmpty:{msg:"error.format.urlpathAndNotEmpty",validator:function(t){var t=e.trim(t);return t.length<1?!1:/^(?!http:\/\/|https:\/\/|:\/\/)(.*)+$/.test(t)}},json:{msg:"error.format.json",validator:function(e){try{var t=/(^\{.*\}$)|(^\[(.*)\]$)/;if(!t.test(e))return!1;JSON.parse(e)}catch(i){return!1}return!0}},number:{msg:"error.format.number",validator:function(t){return""==t?!0:e.isNumeric(t)}},numberAndNotempty:{msg:"error.format.number",validator:function(t){return""==t?!1:e.isNumeric(t)}},latitude:{msg:"error.format.geo",rules:["required","number"],validator:function(e){return Math.abs(e)<=180}},longitude:{msg:"error.format.geo",rules:["required","number"],validator:function(e){return Math.abs(e)<=90}},email:{regex:/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,msg:"error.format.email"},phone:{regex:/^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/,msg:"error.format.phone"},object:{msg:"error.format.object",validator:function(e){if(!/^\s*\{/.test(e))return!1;try{JSON.parse(e)}catch(t){return!1}return!0}},array:{msg:"error.format.array",validator:function(e){if(!/^\s*\[/.test(e))return!1;try{JSON.parse(e)}catch(t){return!1}return!0}},passwordconfirm:{msg:"error.local.passwordconfirm",rules:["required"],validator:function(t,i,n){return e.trim(t)===e.trim(n.password)}},nonemptyemail:{rules:["required","email"]},username:{msg:"error.format.username",validator:function(t){return e.trim(t).length>=6}},password:{msg:"error.format.password",validator:function(t){return e.trim(t).length>=8}},arrayrequired:{msg:"error.format.required",validator:function(e){return e.split(",")[0].length>0}},marketingschedule:{msg:"error.format.marketingschedule",validator:function(e,t){var i=t.find(".begin-at").dropdown("get value");if(0==i){var n=t.next(),a=n.find(".end-at").dropdown("get value");if(0==a){var r=t.find("[name=start_date]").val()+" "+t.find("[name=start_time]").val(),o=n.find("[name=end_date]").val()+" "+t.find("[name=end_time]").val();return o>r}}return!0}},subsciption:{msg:"error.format.required",validator:function(e,t,i){return!(!i||0==i.length)}},exportdata:{msg:"error.format.required",validator:function(e,t,i){return!(!i.classNames||0==i.classNames.length)}},numberbigger:{msg:"error.format.bigger",rules:["number"],validator:function(e,t,i){return i=i||{},!e||!i.compareWithVal||parseInt(e)<parseInt(i.compareWithVal)?!1:!0}},numberGTE0:{msg:"error.format.numberGTE0",validator:function(t){return""==t?!1:e.isNumeric(t)&&/^[1-9][0-9]*$/.test(t)&&t>=0?!0:!1}},numberGTE1:{msg:"error.format.numberGTE1",validator:function(t){return""==t?!1:e.isNumeric(t)&&/^[1-9][0-9]*$/.test(t)&&t>=1?!0:!1}},numberGT0:{msg:"error.format.numberGT0",validator:function(t){return""==t?!1:e.isNumeric(t)&&/^[1-9][0-9]*$/.test(t)&&t>0?!0:!1}},numberBT1To7:{msg:"error.format.numberBT1To7",validator:function(t){return""==t?!1:e.isNumeric(t)&&/^[1-9][0-9]*$/.test(t)&&t>=1&&7>=t?!0:!1}},numberBT1To7AndBigger:{msg:"error.format.numberBT1To7AndBigger",validator:function(t,i,n){return n=n||{},!t||!n.compareWithVal||parseInt(t)<parseInt(n.compareWithVal)?!1:""==t?!1:e.isNumeric(t)&&/^[1-9][0-9]*$/.test(t)&&t>=1&&7>=t?!0:!1}},phoneAndNotempty:{msg:"error.format.phone",validator:function(t){var t=e.trim(t),i=/^(([0\+]\d{2,3}-)?(0\d{2,3})-)?(\d{7,8})(-(\d{3,}))?$/.test(t),n=/^1[3|4|5|6|7|8|9][0-9]{1}[0-9]{8}$/.test(t);return i||n?!0:!1}},checkboxNotEmpty:{msg:"error.local.event-not-empty",validator:function(e,t){return t.find("input:checked").length>0}}}}),define("core/functions/Validator",["app","core/functions/UI","config/validate","jquery","underscore"],function(e,t,i,n,a){function r(e){this.__config=e,this.execute=function(e,t,i){var n={result:!0,msg:"success"},a={result:!1,msg:this.__config.msg},r=this.__config.rules;for(var o in r){var s=r[o].execute(e,t,i);if(!s.result)return s}var c=this.__config.regex;if(c&&!c.test(e))return a;var u=this.__config.validator;return u&&"function"==typeof u&&!u(e,t,i)?a:n}}function o(){this.__rules={},this.init()}o.prototype.addRules=function(e,t){var i=this,n=this.__rules,o=a.extend({},a.pick(t,"regex","msg","validator"));if(t.rules){o.rules=[];try{a.forEach(t.rules,function(e){if("string"==typeof e&&n[e])o.rules.push(n[e]);else{if("object"!=typeof e)throw new Error("Error:rule format error");var a=i.addRules("",t);o.rules.push(a)}})}catch(s){console.log(s)}}var c=new r(o);return e&&(n[e]=c),c},o.prototype.removeRules=function(e){rules[e]="",delete rules[e]},o.prototype.init=function(){var e=this;a.forEach(i,function(t,i){e.addRules(i,t)})},o.prototype.validate=function(e,i){if(1===e.length){/\s?validate-(\w+)\s?/.test(e.attr("class"));var n,a=RegExp.$1,r={};try{e.is(".select2-parts")?n=e.dropdown2("get value"):e.is(".ui.dropdown")?n=e.dropdown("get value"):e.is("input,textarea,select")&&(n=e.val())}catch(o){}return a&&this.__rules[a]&&(r=this.__rules[a].execute(n,e,i)),1==r.result?(t.toggleSuccess(e),!0):(e.unbind(".validate"),t.toggleError(e,r.msg),!1)}var s=this;for(var c in e)if(0==s.validate(e[c]))return!1;return!0},o.prototype.check=function(e){var t=!0,i=this;return n(e).find(".validate").each(function(e,a){0==i.validate(n(a))&&(t=!1)}),t};var s=new o;return s}),require(["main","jquery"],function(){require(["modules/common/bootstrapper","language","Q","tpl!config/timezone.json","API","Storage","Logger","core/functions/Validator","U","pace","C","app"],function(e,t,i,n,a,r,o,s,c,u,l,d){e.init().done(function(){function e(e){$("#billingAddress").val(e.billingAddress),$("#invoiceTitle").val(e.invoiceTitle),$("#name").val(e.name),$("#phone").val(e.phone)}function n(e,t){var n=i.defer();return $("#profile").addClass("loading"),$(".btn-save").addClass("disabled"),$.ajax({url:a.get("orgs")+"/"+d.User.get("orgId"),dataType:"json",type:e,data:JSON.stringify(t)||{},headers:{"X-LAS-Session-Token":l.get("User.SessionToken"),"content-Type":"application/json"}}).done(function(t){n.resolve({data:t,type:e})}).fail(function(e){n.reject(e.responseJSON.errorMessage)}).always(function(){$("#profile").removeClass("loading"),$(".btn-save").removeClass("disabled")}),n.promise}function r(){var e={};return e.billingAddress=$("#billingAddress").val(),e.invoiceTitle=$("#invoiceTitle").val(),e.name=$("#name").val(),e.phone=$("#phone").val(),e}function u(){var e=$("#profile");$(".btn-save").click(function(){if(s.check(e)){var t=r();n("put",t).then(function(){o.success("common.success.update",{doI18n:!0})},function(){o.error("common.fail.update",{doI18n:!0})})}}),e.delegate(".validate","keyup",function(){s.check($(this).parents(".field"))&&m.call(this)})}function m(){$(this).next(".error-msg").remove().end().parents(".field").removeClass("error")}function p(){this.$("[data-tip]").each(function(e,t){var i=$(t).attr("data-tip");$(t).append('<i class="sem-helper-tip icomoon icomoon-help" data-sem-key="'+i+'"></i>')})}t.init(function(){$("#profile-main").i18n(),$("#common-loader").fadeOut(),u(),p(),n("get").then(function(t){e(t.data)},function(e){c.parseError(e)})})})})}),define("orgprofileMain",function(){});